rnorm
?rnorm
rnorm
ls
install.packages("KernSmooth")
library("KernSmooth")
load("~/Documents/emr-bootstrap-actions/R/Hadoop/examples/rmr2_example.R")
x + y
}
add2 <- function(x, y) {
x + y
}
add2(1, 2)
cube <- function(x, n) {
x^3
}
cube(3)
x <- 1:10
if(x > 5) {
x <- 0
}
f <- function(x) {
g <- function(y) {
y + z
}
z <- 4
x + g(x)
}
z <- 10
f(3)
x <- 5
y <- if(x < 3) {
NA
} else {
10
}
y
library(datasets)
data(iris)
?iris
iris
iris['virginica']
for elem in iris:
elem
for elem in iris:
elem
iris
iris[5]
iris[5 = 'virginica']
iris[iris[5] = 'virginica']
iris[iris[5] == 'virginica']
iris[iris[5] == 'virginica'][1]
for (elem in iris) {
elem
}
for (elem in iris) {
print(elem)
}
for (elem in iris) {
print(elem)print('--------\n')
}
for (elem in iris) {
print(elem)
print('--------\n')
}
iris[iris[, 5] == 'virginica']
iris[iris[, 5] == 'virginica',]
iris[iris[, 5] == 'virginica',]['Sepal.Length']
mean(iris[iris[, 5] == 'virginica',]['Sepal.Length'])
.colMeans(iris[iris[, 5] == 'virginica',]['Sepal.Length'])
colMeans(iris[iris[, 5] == 'virginica',]['Sepal.Length'])
iris
iris[,1:4]
apply(iris[,1:4], 1, mean)
apply(iris[,1:4], 2, mean)
library(datasets)
data(mtcars)
?mtcars
mtcars
a$b
mean(mtcars$mpg, mtcars$cyl)
sapply(split(mtcars$mpg, mtcars$cyl), mean)
apply(mtcars, 2, mean)
split(mtcars, mtcars$cyl)
mtcars[mtcars[,2] == '4' || mtcars[,2] == '8']
mtcars[mtcars[,2] == '4' || mtcars[,2] == '8',]
mtcars[mtcars[,2] == '4',]
colMeans(mtcars[mtcars[,2] == '4',]['hp'])
colMeans(mtcars[mtcars[,2] == '8',]['hp'])
a<-colMeans(mtcars[mtcars[,2] == '4',]['hp'])
b<-colMeans(mtcars[mtcars[,2] == '8',]['hp'])
b-a
debug(ls)
ls
debug(ls)
ls
library(ggplot2)
install.packages("ggplot2")
library(ggplot2)
mysubset <- subset(d, select=c("sexo","Baja"))
d <- transform(d, sexo_new= ifelse(sexo=="No informado", "MUJER", "HOMBRE"))
setwd("/Users/tonet/Documents/posgrado/analytics/s2/Sessio2_cursBigData_Profiling/exer2")
d <- read.csv(file="churn.txt", sep=" ")
library(ggplot2)
mysubset <- subset(d, select=c("sexo","Baja"))
ggplot(df)
ggplot(d, aes(experiment, value, fill=metric)) +
ggplot(d, aes(experiment, value, fill=metric))
ggplot(d, aes(experiment, value, fill=metric)) + geom_bar(position="dodge")
ggplot(d, aes(d$sexo, value, fill=metric)) + geom_bar(position="dodge")
ggplot(d, aes(d$Baja, sexo, fill=metric)) + geom_bar(position="dodge")
colores <- c("red","blue")
barplot(counts, main="Distribucion por genero", xlab="Genero", col = colores)
counts <- table(mysubset)
barplot(counts, main="Distribucion por genero", xlab="Genero", col = colores)
barplot(counts, main="Distribucion por genero", xlab="Genero", col = colores)
legend("topleft", c("hombre","mujer"), fill = c("red","blue"))
df = melt(data.frame(A=d$sexo, B=d$Baja,
df = melt(data.frame(A=d$sexo, B=d$Baja, experiment=c("X", "X & Y")), variable_name="metric")
ggplot(df, aes(experiment, value, fill=metric)) + geom_bar(position="dodge")
df = melt(data.frame(A=d$sexo, B=d$Baja, experiment=c("X", "X & Y")), variable_name="metric")
library(ggplot2)
df = melt(data.frame(A=d$sexo, B=d$Baja, experiment=c("X", "X & Y")), variable_name="metric")
library(reshape)
install.packages("reshape")
library(reshape)
df = melt(data.frame(A=d$sexo, B=d$Baja, experiment=c("X", "X & Y")), variable_name="metric")
ggplot(df, aes(experiment, value, fill=metric)) + geom_bar(position="dodge")
ggplot(df, aes(experiment, factor(""), fill=metric)) + geom_bar(position="dodge")
ggplot(df, aes(experiment, factor(""), fill=workshop)) + geom_bar(position="dodge")
ggplot(df, aes(experiment, factor(""), fill=sexo)) + geom_bar(position="dodge")
ggplot(df, aes(experiment, factor(""), fill=d$sexo)) + geom_bar(position="dodge")
ggplot(df, aes(experiment, d$Baja, fill=d$sexo)) + geom_bar(position="dodge")
ggplot(df, aes(experiment, factor(""), fill=d$sexo)) + geom_bar()
ggplot(df, aes(experiment, factor(""), fill=d$sexo)) + geom_bar(stat="identity")
ggplot(df, aes(d$sexo, fill=d$sexo)) + geom_bar(stat="identity")
ggplot(df, aes(d$sexo, factor(""), fill=d$sexo)) + geom_bar(stat="identity")
ggplot(df, aes(d$sexo, factor(""), fill=d$sexo)) + geom_bar(stat="identity")
ggplot(df, aes(experiment, factor(""), fill=d$sexo)) + geom_bar(stat="identity")
df = melt(data.frame(A=d$sexo, B=d$Baja, experiment=c(d$Baja)), variable_name="metric")
ggplot(df, aes(experiment, factor(""), fill=d$sexo)) + geom_bar(stat="identity")
ggplot(mysubset, aes(mysubset$sexo, fill=workshop) ) + geom_bar(position="fill")
ggplot(mysubset, aes(mysubset$sexo, fill=mysubset$Baja) ) + geom_bar(position="fill")
ggplot(mysubset, aes(mysubset$Baja, fill=mysubset$sexo) ) + geom_bar(position="fill")
ggplot(mysubset, aes(mysubset$Baja, fill=mysubset$sexo) ) + geom_bar(position="fill")
ggplot(mysubset, aes(mysubset$Baja, fill=mysubset$sexo) ) + geom_bar(position="dodge")
ggplot(mysubset, aes(mysubset$Baja, fill=mysubset$sexo) ) + geom_bar(position="dodge") + scale_x_discrete("ABC")
ggplot(mysubset, aes(mysubset$Baja, fill=mysubset$sexo) ) + geom_bar(position="dodge") + scale_x_discrete("Bajas")
d <- transform(d, sexo_new= ifelse(sexo=="No informado", "MUJER", "HOMBRE"))
mysubset <- subset(d, select=c("sexo","Baja"))
ggplot(mysubset, aes(mysubset$Baja, fill=mysubset$sexo) ) + geom_bar(position="dodge") + scale_x_discrete("Bajas")
d$sexo <- d$sexo_new
d$sexo_new <- NULL
mysubset <- subset(d, select=c("sexo","Baja"))
ggplot(mysubset, aes(mysubset$Baja, fill=mysubset$sexo) ) + geom_bar(position="dodge") + scale_x_discrete("Bajas")
ggplot(mysubset, aes(mysubset$Baja, fill=mysubset$sexo) ) + geom_bar(position="dodge") + scale_x_discrete("Bajas") + theme(legend.title="Sexo")
+ geom_bar(position="dodge") + scale_x_discrete("Bajas") + theme(legend.title=element_blank())
+ geom_bar(position="dodge") + scale_x_discrete("Bajas")
ggplot(mysubset, aes(mysubset$Baja, fill=mysubset$sexo) ) + geom_bar(position="dodge") + scale_x_discrete("Bajas") + theme(legend.title=element_blank())
hist(d$antig)
mysubset <- subset(d, select=c("sexo","antig"))
ggplot(data=mysubset, aes(mysubset$antig)) + geom_histogram(breaks=seq(20, 50, by =2), col="red", aes(fill=..count..)) + scale_fill_gradient("Count", low = "green", high = "red")
ggplot(data=mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(20, 50, by =2), col="red", aes(fill=..count..)) + scale_fill_gradient("Count", low = "green", high = "red")
ggplot(data=mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(20, 50, by =2), col="red", aes(fill=..count..))
ggplot(data=mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(col="black", aes(fill=..count..))
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(0, 100, by =2), col="black", aes(fill=..count..))
hist(d$antig)
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(0, 100), col="black", aes(fill=..count..))
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(0, 100), col="black", aes(fill=..count..)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("antig","Baja"))
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(0, 100), col="black", aes(fill=..count..)) + theme(legend.title=element_blank())
mysubset
mysubset$Baja
mysubset$antig
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(0, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + scale_x_discrete("Antiguedad") + geom_histogram(breaks=seq(0, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(0, 100), col="black", aes(fill=mysubset$Baja)) + scale_x_discrete("Antiguedad") + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(0, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
max(mysubset$antig)
max_val <- max(mysubset$antig)
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + labs("ab") + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank()) + labs("ab")
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank()) + scale_x_discrete("Bajas")
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja), stat = "count") + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank()) + scale_x_discrete("Bajas")
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank()) + labs(title="Histogram for Age")
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank()) + labs(x="Age", y="Count")
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank()) + labs(x="Antiguedad", y="count")
install.packages("ggplot2", dependencies = TRUE)
install.packages("ggplot2", dependencies = TRUE)
library(FactoMineR)
install.packages("FactoMineR")
library(FactoMineR)
d <- read.csv(file="churn.txt", sep=" ")
setwd("/Users/tonet/Documents/posgrado/analytics/s2/Sessio2_cursBigData_Profiling/exer2")
d <- read.csv(file="churn.txt", sep=" ")
res = catdes(d, num.var=23, proba=0.05)
?catdes
d
d[0]
d[1]
res = catdes(d, num.var=1, proba=0.05)
res
mysubset <- subset(d, select=c("sexo","Baja"))
ggplot(mysubset, aes(mysubset$Baja, fill=mysubset$sexo) ) + geom_bar(position="dodge") + scale_x_discrete("Bajas") + theme(legend.title=element_blank())
library(ggplot2)
ggplot(mysubset, aes(mysubset$Baja, fill=mysubset$sexo) ) + geom_bar(position="dodge") + scale_x_discrete("Bajas") + theme(legend.title=element_blank())
d <- transform(d, sexo_new= ifelse(sexo=="No informado", "MUJER", "HOMBRE"))
d$sexo <- d$sexo_new
d$sexo_new <- NULL
ggplot(mysubset, aes(mysubset$sexo, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("Sexo") + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("sexo","Baja"))
ggplot(mysubset, aes(mysubset$sexo, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("Sexo") + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("Nomina","Baja"))
ggplot(mysubset, aes(mysubset$sexo, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("Sexo") + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Nomina, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("Sexo") + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Nomina, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("Nomina") + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("Pension","Baja"))
ggplot(mysubset, aes(mysubset$Pension, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("Pension") + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("Debito_normal","Baja"))
ggplot(mysubset, aes(mysubset$Debito_normal, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("Debito_normal") + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("Debito_aff","Baja"))
ggplot(mysubset, aes(mysubset$Debito_aff, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("Debito_aff") + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("VISA","Baja"))
ggplot(mysubset, aes(mysubset$VISA, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("Debito_aff") + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("VISA_aff","Baja"))
ggplot(mysubset, aes(mysubset$VISA_aff, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("Debito_aff") + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("MCard","Baja"))
ggplot(mysubset, aes(mysubset$MCard, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("Debito_aff") + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("Amex","Baja"))
ggplot(mysubset, aes(mysubset$Amex, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("Debito_aff") + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("dif_resid","Baja"))
ggplot(mysubset, aes(mysubset$dif_resid, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("Debito_aff") + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("antig","Baja"))
max_val <- max(mysubset$antig)
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank()) + labs(x="Antiguedad", y="count")
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + labs(x="Antiguedad", y="count") + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$antig, fill=mysubset$Baja)) + labs(x="antig", y="count") + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("edatcat","Baja"))
max_val <- max(mysubset$edatcat)
ggplot(mysubset, aes(mysubset$edatcat, fill=mysubset$Baja)) + labs(x="edatcat", y="count") + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("edatcat","Baja"))
max_val <- max(mysubset$edatcat)
d$edatcat
max_val <- 10#max(mysubset$edatcat)
ggplot(mysubset, aes(mysubset$edatcat, fill=mysubset$Baja)) + labs(x="edatcat", y="count") + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("Total_activo","Baja"))
max_val <- max(mysubset$Total_activo)
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja)) + labs(x="Total_activo", y="count") + geom_histogram(binwidth = 1000,breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja)) + labs(x="Total_activo", y="count") + geom_histogram(binwidth = 1000,breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("Total_activo","Baja"))
max_val <- max(mysubset$Total_activo)
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja)) + labs(x="Total_activo", y="count") + geom_histogram(binwidth = 10000,breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja), binwidth = 10000) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja, binwidth = 10000)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja, binwidth = 10000)) + labs(x="Total_activo", y="count") + col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja, binwidth = 10000)) + labs(x="Total_activo", y="count") + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja, binwidth = 1000)) + labs(x="Total_activo", y="count") + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja, binwidth = 10000)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=1000, col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja, binwidth = 10000)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
seq(0,100)
?seq
seq(0,100,2)
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja, binwidth = 10000)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, 100,10), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja, binwidth = 10000)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=(1,100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja, binwidth = 10000)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=[0,100,1000], col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja, binwidth = 10000)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, max_val, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja, binwidth = 10000)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("edatcat","Baja"))
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$edatcat, binwidth = 10000)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
hist(mysubset$edatcat)
mysubset <- subset(d, select=c("edatcat","Baja"))
ggplot(mysubset, aes(mysubset$edatcat, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("edatcat") + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$edatcat, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("edatcat") + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("Total_Plazo","Baja"))
hist(mysubset$Total_Plazo)
max_val <- max(mysubset$Total_Plazo)
mysubset <- subset(d, select=c("Total_Plazo","Baja"))
max_val <- max(mysubset$Total_Plazo)
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja, binwidth = 10000)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
max_val <- max(mysubset$Total_Plazo)
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_activo, fill=mysubset$Baja)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, 2000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_Plazo, fill=mysubset$Baja)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, 2000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_Plazo, fill=mysubset$Baja)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, max_val), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_Plazo, fill=mysubset$Baja)) + labs(x="Total_activo", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$Total_Plazo, fill=mysubset$Baja)) + labs(x="Total_Plazo", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("Total_Inversion","Baja"))
max_val <- max(mysubset$Total_Inversion)
ggplot(mysubset, aes(mysubset$Total_Inversion, fill=mysubset$Baja)) + labs(x="Total_Inversion", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("Total_Seguros","Baja"))
max_val <- max(mysubset$Total_Seguros)
ggplot(mysubset, aes(mysubset$Total_Seguros, fill=mysubset$Baja)) + labs(x="Total_Seguros", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("Total_Vista","Baja"))
max_val <- max(mysubset$Total_Vista)
ggplot(mysubset, aes(mysubset$Total_Vista, fill=mysubset$Baja)) + labs(x="Total_Vista", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("oper_caj_Libreta","Baja"))
max_val <- max(mysubset$oper_caj_Libreta)
ggplot(mysubset, aes(mysubset$oper_caj_Libreta, fill=mysubset$Baja)) + labs(x="Total_Vista", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("oper_ven_Libreta","Baja"))
max_val <- max(mysubset$oper_ven_Libreta)
ggplot(mysubset, aes(mysubset$oper_ven_Libreta, fill=mysubset$Baja)) + labs(x="oper_ven_Libreta", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("dif_CC","Baja"))
max_val <- max(mysubset$dif_CC)
ggplot(mysubset, aes(mysubset$dif_CC, fill=mysubset$Baja)) + labs(x="dif_CC", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("dif_Libreta","Baja"))
max_val <- max(mysubset$dif_Libreta)
ggplot(mysubset, aes(mysubset$dif_Libreta, fill=mysubset$Baja)) + labs(x="dif_Libreta", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("dif_Plazo","Baja"))
max_val <- max(mysubset$dif_Plazo)
ggplot(mysubset, aes(mysubset$dif_Plazo, fill=mysubset$Baja)) + labs(x="dif_Plazo", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("dif_Ahorro","Baja"))
max_val <- max(mysubset$dif_Ahorro)
ggplot(mysubset, aes(mysubset$dif_Ahorro, fill=mysubset$Baja)) + labs(x="dif_Ahorro", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$dif_Ahorro, fill=mysubset$Baja)) + labs(x="dif_Ahorro", y="count") + geom_histogram(breaks=seq(0, max_val, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$dif_Ahorro, fill=mysubset$Baja)) + labs(x="dif_Ahorro", y="count") + geom_histogram(breaks=seq(0, max_val, 50), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$dif_Largo_plazo, fill=mysubset$Baja)) + labs(x="dif_Largo_plazo", y="count") + geom_histogram(breaks=seq(0, max_val, 50), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("dif_Largo_plazo","Baja"))
max_val <- max(mysubset$dif_Largo_plazo)
ggplot(mysubset, aes(mysubset$dif_Largo_plazo, fill=mysubset$Baja)) + labs(x="dif_Largo_plazo", y="count") + geom_histogram(breaks=seq(0, max_val, 50), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("dif_Fondos_inv","Baja"))
max_val <- max(mysubset$dif_Fondos_inv)
ggplot(mysubset, aes(mysubset$dif_Fondos_inv, fill=mysubset$Baja)) + labs(x="dif_Fondos_inv", y="count") + geom_histogram(breaks=seq(0, max_val, 50), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$dif_Fondos_inv, fill=mysubset$Baja)) + labs(x="dif_Fondos_inv", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("dif_Seguros","Baja"))
max_val <- max(mysubset$dif_Seguros)
ggplot(mysubset, aes(mysubset$dif_Seguros, fill=mysubset$Baja)) + labs(x="dif_Seguros", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("dif_Planes_pension","Baja"))
max_val <- max(mysubset$dif_Planes_pension)
ggplot(mysubset, aes(mysubset$dif_Planes_pension, fill=mysubset$Baja)) + labs(x="dif_Planes_pension", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("dif_Hipoteca","Baja"))
max_val <- max(mysubset$dif_Hipoteca)
ggplot(mysubset, aes(mysubset$dif_Hipoteca, fill=mysubset$Baja)) + labs(x="dif_Hipoteca", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("dif_Prest_personales","Baja"))
max_val <- max(mysubset$dif_Prest_personales)
ggplot(mysubset, aes(mysubset$dif_Prest_personales, fill=mysubset$Baja)) + labs(x="dif_Prest_personales", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
catdes(d, num.var=1, proba=0.05)
mysubset <- subset(d, select=c("edatcat","Baja"))
ggplot(mysubset, aes(mysubset$edatcat, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("edatcat") + theme(legend.title=element_blank())
mysubset <- subset(d, select=c("dif_Ahorro","Baja"))
max_val <- max(mysubset$dif_Ahorro)
ggplot(mysubset, aes(mysubset$dif_Ahorro, fill=mysubset$Baja)) + labs(x="dif_Ahorro", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
row_sub = apply(mysubset, 1, function(row) all(row !=0 ))
hist(row_sub)
mysubset <- subset(d, select=c("dif_Ahorro","Baja"), dif_Ahorro > 0)
max_val <- max(mysubset$dif_Ahorro)
ggplot(mysubset, aes(mysubset$dif_Ahorro, fill=mysubset$Baja)) + labs(x="dif_Ahorro", y="count") + geom_histogram(breaks=seq(0, max_val, 1000), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$dif_Ahorro, fill=mysubset$Baja)) + labs(x="dif_Ahorro", y="count") + geom_histogram(breaks=seq(0, max_val, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(mysubset$dif_Ahorro, fill=mysubset$Baja)) + geom_bar(aes(y = (..count..)/sum(..count..))) + labs(x="dif_Ahorro", y="count") + geom_histogram(breaks=seq(0, max_val, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
churn2$dif_Ahorro = cut(d$dif_Ahorro, breaks=c(0,0.0001,150,400,1000,3000,99000),include.lowest=T)
cut(d$dif_Ahorro, breaks=c(0,0.0001,150,400,1000,3000,99000),include.lowest=T)
a<-cut(d$dif_Ahorro, breaks=c(0,0.0001,150,400,1000,3000,99000),include.lowest=T)
hist(a)
d$dif_Ahorro_new<-cut(d$dif_Ahorro, breaks=c(0,0.0001,150,400,1000,3000,99000),include.lowest=T)
ggplot(mysubset, aes(mysubset$dif_Ahorro_new, fill=mysubset$Baja)) + labs(x="dif_Ahorro_new", y="count") + geom_histogram(breaks=seq(0, max_val, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
max_val <- max(mysubset$dif_Ahorro_new)
ggplot(mysubset, aes(mysubset$dif_Ahorro_new, fill=mysubset$Baja)) + labs(x="dif_Ahorro_new", y="count") + geom_histogram(breaks=seq(0, max_val, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
max_val <- max(mysubset$dif_Ahorro_new, na.rm=TRUE)
d$dif_Ahorro_new<-cut(d$dif_Ahorro, breaks=c(0,0.0001,150,400,1000,3000,99000),include.lowest=T, na.rm=TRUE)
max_val <- max(mysubset$dif_Ahorro_new, na.rm=TRUE)
ggplot(mysubset, aes(mysubset$dif_Ahorro_new, fill=mysubset$Baja)) + labs(x="dif_Ahorro_new", y="count") + geom_histogram(breaks=seq(0, max_val, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
max_val
d$dif_Ahorro_new
d$dif_Ahorro_new<-na.omit(d$dif_Ahorro_new)
aux<-na.omit(d$dif_Ahorro_new)
ggplot(mysubset, aes(aux, fill=mysubset$Baja)) + labs(x="aux", y="count") + geom_histogram(breaks=seq(0, max_val, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(mysubset, aes(aux, fill=mysubset$Baja)) + labs(x="aux", y="count") + geom_histogram(breaks=seq(0, 10, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
d <- read.csv(file="churn.txt", sep=" ")
d <- transform(d, sexo_new= ifelse(sexo=="No informado", "MUJER", "HOMBRE"))
d$sexo <- d$sexo_new
d$sexo_new <- NULL
churn <- read.csv(file="churn.txt", sep=" ")
churn2 = churn
churn2$Rec_dif_Ahorro = cut(churn$dif_Ahorro, breaks=c(-99000,-100,-0.0001,0,20,200,1000,99000))
churn2$Rec_dif_Ahorro
mysubset <- subset(churn2, select=c("Rec_dif_Ahorro","Baja"))
max_val <- max(churn2$Rec_dif_Ahorro)
max_val <- 1000
ggplot(churn2, aes(churn2$Rec_dif_Ahorro, fill=churn2$Baja)) + labs(x="Rec_dif_Ahorro", y="count") + geom_histogram(breaks=seq(0, max_val, 100), col="black", aes(fill=mysubset$Baja)) + theme(legend.title=element_blank())
ggplot(churn2, aes(churn2$Rec_dif_Ahorro, fill=churn2$Baja)) + labs(x="Rec_dif_Ahorro", y="count") + geom_histogram(breaks=seq(0, max_val, 100), col="black", aes(fill=churn2$Baja)) + theme(legend.title=element_blank())
hist(churn2$Rec_dif_Ahorro)
churn2$Rec_dif_Ahorro
ggplot(mysubset, aes(mysubset$Rec_dif_Ahorro, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("Rec_dif_Ahorro") + theme(legend.title=element_blank())
20*100/393
6*100/322
393*0.0509
3*100/179
4*100/297
17*100/214
2*100/25
library(FactoMineR)
catdes(d, num.var=1, proba=0.05)
d <- transform(d, sexo_new= ifelse(sexo=="No informado", "MUJER", "HOMBRE"))
d$sexo <- d$sexo_new
d$sexo_new <- NULL
library(ggplot2)
mysubset <- subset(d, select=c("edatcat","sexo", "Baja"))
ggplot(mysubset, aes(mysubset$edatcat, fill=mysubset$Baja) ) + geom_bar(position="dodge") + scale_x_discrete("edatcat") + theme(legend.title=element_blank())
setwd("/Users/tonet/Documents/posgrado/analytics/s2/Sessio3_cursBigData_CART/R")
?rpart
package.install("rpart")
package.installed("rpart")
install.packages("rpart")
?rpart
library(rpart)
?rpart
fit <- rpart(Kyphosis ~ Age + Number + Start, data = kyphosis)
fit
plot(fit)
text(fit, use.n = TRUE)
plot(fit2)
text(fit2, use.n = TRUE)
printcp(fit)
text(fit2, use.n = TRUE)
plot(fit2)
59/60
0.8*0.2 + 0.2*0.8
1/60
(59/60)*(1-(59/60)) + (1/60)*(1-(1/60))
21/40
(21/40)*(1-(21/40)) + (19/40)*(1-(19/40))
20/100
1/60
21/40
rroot <- 1 - 8/10
r2 <- 1 - 59/60
r3 <- 1 - 21/40
Rt <- (((0.6)*r2 + (0.4)*r3)/rroot)*100
Rt
rroot
r2
r3
r1 <- 1 – (20/100)
r1 <- 1-(20/100)
r2 <- 1-(1/60)
r3 <- 1-(21/40)
Rt <- (((0.6)*r2 + (0.4)*r3)/r1)*100
Rt
d <- read.csv(file="churn.txt", sep=" ")
library(rpart)
names(churn)
m<-rpart(Baja ~ ., data=d, control=rpart.control( cp = 0.0001, xval=10))
printcp(m)
plot(m)
m$cptable = as.data.frame(m$cptable) ind = which.min(m$cptable$xerror) xerr <- m$cptable$xerror[ind]
m$cptable = as.data.frame(m$cptable)
ind = which.min(m$cptable$xerror)
xerr <- m$cptable$xerror[ind]
xstd <- p2$cptable$xstd[ind]
xstd <- m$cptable$xstd[ind]
i=1
while (m$cptable$xerror[i] > xerr+xstd) i = i+1 alfa = m$cptable$CP[i]
while (m$cptable$xerror[i] > xerr+xstd) i = i+1
alfa = m$cptable$CP[i]
m1 <- prune(m,cp=alfa)
m1
plotcp(m)
plot(m)
plot(m)
plot(m)
plot(m1)
install.packages("rpart.plot")
setwd("/Users/tonet/Documents/posgrado/analytics/s2/Sessio3_cursBigData_CART/R")
install.packages("rpart.plot")
library("rpart.plot")
rpart.plot(m1)
m1$variable
m1$variable.importance
}
}
m1$rules
rpart.rules(m1)
library("rpart.rules")
install.packages("rpart.rules")
library("rpart")
rpart.rules(m1)
rpart.list(m1)
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
